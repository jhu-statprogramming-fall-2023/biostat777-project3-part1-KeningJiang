<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="table1">
<title>Example analysis • table1</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example analysis">
<meta property="og:description" content="table1">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">table1</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <h6 class="dropdown-header" data-toc-skip>Kening Jiang</h6>
    <a class="dropdown-item" href="../articles/Example%20analysis.html">Example analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Benjamin Rich</h6>
    <a class="dropdown-item" href="../articles/table1-examples.html">Using the table1 Package to Create HTML Tables of Descriptive Statistics</a>
    <a class="dropdown-item" href="../articles/table1-latex.html">Using table1 with LaTeX and MS Word</a>
  </div>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="Example%20analysis_files/table1-1.0/table1_defaults.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example analysis</h1>
                        <h4 data-toc-skip class="author">Kening
Jiang</h4>
            
            <h4 data-toc-skip class="date">2023-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/benjaminrich/table1/blob/HEAD/vignettes/Example%20analysis.Rmd" class="external-link"><code>vignettes/Example analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Example analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="research-question">Research question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h2>
<p>Examine hotel cancellations and factors associated with hotel
cancellations in the United States between 2015 and 2017.</p>
</div>
<div class="section level2">
<h2 id="origin-data">Origin data<a class="anchor" aria-label="anchor" href="#origin-data"></a>
</h2>
<p>The dataset is included in <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-02-11#readme" class="external-link">TidyTuesday,
2020-02-11</a>. The original dataset comes from an open hotel booking
demand dataset from <a href="https://www.sciencedirect.com/science/article/pii/S2352340918315191#f0010" class="external-link">Antonio,
Almeida and Nunes, 2019</a>. This dataset includes bookings of resort
hotels or city hotels between the 1st of July of 2015 and the 31st of
August 2017, including bookings that effectively arrived and bookings
that were canceled.</p>
</div>
<div class="section level2">
<h2 id="data-dictionary">Data dictionary<a class="anchor" aria-label="anchor" href="#data-dictionary"></a>
</h2>
<p><a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-02-11#data-dictionary" class="external-link">Variables
in Hotels</a></p>
</div>
<div class="section level2">
<h2 id="data-management">Data management<a class="anchor" aria-label="anchor" href="#data-management"></a>
</h2>
<div class="section level3">
<h3 id="set-up-the-dataset">Set up the dataset<a class="anchor" aria-label="anchor" href="#set-up-the-dataset"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests if a directory named "data" exists locally</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"hotels.RDS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu">tidytuesdayR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytuesdayR/man/tt_load.html" class="external-link">tt_load</a></span><span class="op">(</span><span class="st">"2020-02-11"</span><span class="op">)</span></span>
<span>    <span class="va">hotels</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">hotels</span></span>
<span>    <span class="co"># save the files to RDS object</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">tuesdata</span><span class="op">$</span><span class="va">hotels</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"hotels.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>Downloading file 1 of 3: `H1.csv`
Downloading file 2 of 3: `H2.csv`
Downloading file 3 of 3: `hotels.csv`</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the dataset</span></span>
<span><span class="va">hotels</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"hotels.RDS"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for USA hotel bookings and select relevant variables</span></span>
<span><span class="va">hotels_clean</span><span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span><span class="op">==</span><span class="st">"USA"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'arrival_date_week_number'</span>,<span class="st">'arrival_date_day_of_month'</span>, <span class="st">'meal'</span>,<span class="st">'country'</span>, <span class="st">'market_segment'</span>, <span class="st">'distribution_channel'</span>, </span>
<span>            <span class="st">'reserved_room_type'</span>, <span class="st">'assigned_room_type'</span>, <span class="st">'agent'</span>, <span class="st">'company'</span>, <span class="st">'days_in_waiting_list'</span>, <span class="st">'required_car_parking_spaces'</span>, </span>
<span>            <span class="st">'total_of_special_requests'</span>, <span class="st">'reservation_status'</span>, <span class="st">'reservation_status_date'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Drop the observations with missing values</span></span>
<span><span class="va">hotels_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Glimpse the cleaned dataset</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 2,097</span></span>
<span><span class="co">## Columns: 17</span></span>
<span><span class="co">## $ hotel                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Resort Hotel", "Resort Hotel", "Resort…</span></span>
<span><span class="co">## $ is_canceled                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">## $ lead_time                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 68, 14, 10, 9, 51, 51, 98, 88, 10, 42, …</span></span>
<span><span class="co">## $ arrival_date_year              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2015, 2015, 2015, 2015, 2015, 2015, 201…</span></span>
<span><span class="co">## $ arrival_date_month             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "July", "July", "July", "July", "July",…</span></span>
<span><span class="co">## $ stays_in_weekend_nights        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 2, …</span></span>
<span><span class="co">## $ stays_in_week_nights           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4, 2, 2, 1, 3, 3, 1, 4, 1, 2, 1, 1, 8, …</span></span>
<span><span class="co">## $ adults                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 2, 2, 2, 2, 3, 2, 3, 2, 2, 2, 2, 2, …</span></span>
<span><span class="co">## $ children                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, …</span></span>
<span><span class="co">## $ babies                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">## $ is_repeated_guest              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">## $ previous_cancellations         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">## $ previous_bookings_not_canceled <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">## $ booking_changes                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, …</span></span>
<span><span class="co">## $ deposit_type                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "No Deposit", "No Deposit", "No Deposit…</span></span>
<span><span class="co">## $ customer_type                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Transient", "Transient", "Transient", …</span></span>
<span><span class="co">## $ adr                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 97.00, 98.00, 153.00, 94.71, 117.81, 11…</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="create-variables-for-analysis">Create variables for analysis<a class="anchor" aria-label="anchor" href="#create-variables-for-analysis"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hotels_clean</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels_clean</span> <span class="op">%&gt;%</span></span>
<span><span class="co"># Mutate the year variable to a factor variable</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>  arrival_date_year <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">arrival_date_year</span><span class="op">==</span><span class="fl">2015</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                            <span class="va">arrival_date_year</span><span class="op">==</span><span class="fl">2016</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                            <span class="va">arrival_date_year</span><span class="op">==</span><span class="fl">2017</span> <span class="op">~</span> <span class="fl">2</span><span class="op">)</span> </span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="co"># Combine the month variable for a season variable</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>  arrival_date_month <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">arrival_date_month</span>,</span>
<span>  January <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  February <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  March <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  April <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  May <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  June <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  July <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  August <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  September <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  October <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  November <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  December <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>arrival_date_season <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">arrival_date_month</span> <span class="op">&gt;=</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">arrival_date_month</span> <span class="op">&lt;=</span><span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                            <span class="va">arrival_date_month</span> <span class="op">&gt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">arrival_date_month</span> <span class="op">&lt;=</span> <span class="fl">8</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                            <span class="va">arrival_date_month</span> <span class="op">&gt;=</span> <span class="fl">9</span> <span class="op">&amp;</span> <span class="va">arrival_date_month</span> <span class="op">&lt;=</span> <span class="fl">11</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>                            <span class="va">arrival_date_month</span> <span class="op">==</span> <span class="fl">12</span> <span class="op">|</span> <span class="va">arrival_date_month</span> <span class="op">&lt;=</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="co"># Create a combined variable for number of children and babies due to small numbers</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>childbaby <span class="op">=</span> <span class="va">children</span> <span class="op">+</span> <span class="va">babies</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="label-variables">Label variables<a class="anchor" aria-label="anchor" href="#label-variables"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lable the factor variables</span></span>
<span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">is_canceled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">is_canceled</span>, levels<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_year</span>, levels<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2015"</span>, <span class="st">"2016"</span>, <span class="st">"2017"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_season</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_season</span>, levels<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Fall"</span>, <span class="st">"Winter"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">is_repeated_guest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">is_repeated_guest</span>, levels<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use label() function from table1 package to label the variables</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">hotel</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Type of hotel"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">lead_time</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of days between booking and arrival"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_year</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Year of arrival date"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">arrival_date_season</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Season of arrival date"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">stays_in_weekend_nights</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of weekend nights stayed"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">stays_in_week_nights</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of week nights stayed"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">adults</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of adults"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">childbaby</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of children and babies"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">is_repeated_guest</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Repeated guest"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">booking_changes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Number of changes to the booking"</span></span>
<span><span class="fu"><a href="../reference/label.html">label</a></span><span class="op">(</span><span class="va">hotels_clean</span><span class="op">$</span><span class="va">adr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Average daily rate, $"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="table-1-characteristics-of-hotel-bookings-overall-and-by-cancellation">Table 1: Characteristics of hotel bookings overall and by
cancellation<a class="anchor" aria-label="anchor" href="#table-1-characteristics-of-hotel-bookings-overall-and-by-cancellation"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table1.html">table1</a></span><span class="op">(</span><span class="op">~</span> <span class="va">hotel</span> <span class="op">+</span> <span class="va">lead_time</span> <span class="op">+</span> <span class="va">arrival_date_year</span> <span class="op">+</span> <span class="va">arrival_date_season</span> <span class="op">+</span> </span>
<span>         <span class="va">stays_in_weekend_nights</span> <span class="op">+</span> <span class="va">stays_in_week_nights</span> <span class="op">+</span> <span class="va">adults</span> <span class="op">+</span> </span>
<span>         <span class="va">childbaby</span> <span class="op">+</span> <span class="va">is_repeated_guest</span> <span class="op">+</span> <span class="va">booking_changes</span> <span class="op">+</span> <span class="va">adr</span></span>
<span>         <span class="op">|</span> <span class="va">is_canceled</span>, data<span class="op">=</span><span class="va">hotels_clean</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>left<span class="op">=</span><span class="st">"Overall"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="Rtable1"><table class="table Rtable1">
<thead><tr>
<th class="rowlabel firstrow lastrow"></th>
<th class="firstrow lastrow"><span class="stratlabel">Overall<br><span class="stratn">(N=2097)</span></span></th>
<th class="firstrow lastrow"><span class="stratlabel">No<br><span class="stratn">(N=1596)</span></span></th>
<th class="firstrow lastrow"><span class="stratlabel">Yes<br><span class="stratn">(N=501)</span></span></th>
</tr></thead>
<tbody>
<tr>
<td class="rowlabel firstrow">Type of hotel</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">City Hotel</td>
<td>1618 (77.2%)</td>
<td>1189 (74.5%)</td>
<td>429 (85.6%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Resort Hotel</td>
<td class="lastrow">479 (22.8%)</td>
<td class="lastrow">407 (25.5%)</td>
<td class="lastrow">72 (14.4%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of days between booking and arrival</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>77.2 (82.7)</td>
<td>70.7 (82.6)</td>
<td>97.8 (79.8)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">51.0 [0, 542]</td>
<td class="lastrow">40.0 [0, 542]</td>
<td class="lastrow">77.0 [0, 327]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Year of arrival date</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">2015</td>
<td>180 (8.6%)</td>
<td>180 (11.3%)</td>
<td>0 (0%)</td>
</tr>
<tr>
<td class="rowlabel">2016</td>
<td>963 (45.9%)</td>
<td>748 (46.9%)</td>
<td>215 (42.9%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">2017</td>
<td class="lastrow">954 (45.5%)</td>
<td class="lastrow">668 (41.9%)</td>
<td class="lastrow">286 (57.1%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">Season of arrival date</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Spring</td>
<td>589 (28.1%)</td>
<td>426 (26.7%)</td>
<td>163 (32.5%)</td>
</tr>
<tr>
<td class="rowlabel">Summer</td>
<td>851 (40.6%)</td>
<td>616 (38.6%)</td>
<td>235 (46.9%)</td>
</tr>
<tr>
<td class="rowlabel">Fall</td>
<td>412 (19.6%)</td>
<td>354 (22.2%)</td>
<td>58 (11.6%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Winter</td>
<td class="lastrow">245 (11.7%)</td>
<td class="lastrow">200 (12.5%)</td>
<td class="lastrow">45 (9.0%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of weekend nights stayed</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>0.855 (0.929)</td>
<td>0.812 (0.921)</td>
<td>0.992 (0.942)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">1.00 [0, 13.0]</td>
<td class="lastrow">1.00 [0, 13.0]</td>
<td class="lastrow">1.00 [0, 5.00]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of week nights stayed</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>1.92 (1.67)</td>
<td>1.83 (1.64)</td>
<td>2.21 (1.73)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">2.00 [0, 30.0]</td>
<td class="lastrow">1.00 [0, 30.0]</td>
<td class="lastrow">2.00 [0, 11.0]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of adults</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>1.88 (0.526)</td>
<td>1.86 (0.521)</td>
<td>1.95 (0.535)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">2.00 [0, 4.00]</td>
<td class="lastrow">2.00 [0, 4.00]</td>
<td class="lastrow">2.00 [0, 3.00]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of children and babies</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>0.175 (0.534)</td>
<td>0.150 (0.492)</td>
<td>0.255 (0.644)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">0 [0, 3.00]</td>
<td class="lastrow">0 [0, 3.00]</td>
<td class="lastrow">0 [0, 2.00]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Repeated guest</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">No</td>
<td>2078 (99.1%)</td>
<td>1578 (98.9%)</td>
<td>500 (99.8%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Yes</td>
<td class="lastrow">19 (0.9%)</td>
<td class="lastrow">18 (1.1%)</td>
<td class="lastrow">1 (0.2%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">Number of changes to the booking</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>0.339 (0.866)</td>
<td>0.367 (0.922)</td>
<td>0.250 (0.654)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">0 [0, 14.0]</td>
<td class="lastrow">0 [0, 14.0]</td>
<td class="lastrow">0 [0, 5.00]</td>
</tr>
<tr>
<td class="rowlabel firstrow">Average daily rate, $</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>123 (51.6)</td>
<td>119 (51.4)</td>
<td>136 (50.1)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">115 [0, 328]</td>
<td class="lastrow">109 [0, 328]</td>
<td class="lastrow">128 [0, 311]</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section level3">
<h3 id="figure-1-number-of-completed-and-cancelled-hotel-bookings-by-season-and-year">Figure 1: Number of completed and cancelled hotel bookings by season
and year<a class="anchor" aria-label="anchor" href="#figure-1-number-of-completed-and-cancelled-hotel-bookings-by-season-and-year"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a custom theme to start with</span></span>
<span><span class="va">custom_theme</span> <span class="op">&lt;-</span> <span class="fu">theme</span><span class="op">(</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  axis.ticks <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>  axis.line <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data for figure 1</span></span>
<span><span class="va">hotels_summary1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels_clean</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">arrival_date_year</span>, <span class="va">arrival_date_season</span>, <span class="va">is_canceled</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'arrival_date_year', 'arrival_date_season'.</span></span>
<span><span class="co">## You can override using the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate figure 1 using geom_bar()</span></span>
<span><span class="va">figure1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">hotels_summary1</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">arrival_date_season</span>, y<span class="op">=</span><span class="va">n</span>, fill<span class="op">=</span><span class="va">is_canceled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add stacked bar plot</span></span>
<span>           <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Specify color manual</span></span>
<span>           <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cancelled booking"</span>,</span>
<span>                             values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#40B0A6"</span>, <span class="st">"#E1BE6A"</span><span class="op">)</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">arrival_date_year</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add labels</span></span>
<span>           <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Season"</span>,</span>
<span>                y<span class="op">=</span><span class="st">"Number of hotel bookings"</span>,</span>
<span>                title<span class="op">=</span><span class="st">"Number of completed and cancelled hotel bookings by season and year"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"Larger number of bookings and cancellations during summer"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the theme</span></span>
<span>           <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       strip.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#D3E1D0"</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">figure1</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure1-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="figure-2-number-of-completed-and-cancelled-hotel-bookings-by-hotel-type">Figure 2: Number of completed and cancelled hotel bookings by hotel
type<a class="anchor" aria-label="anchor" href="#figure-2-number-of-completed-and-cancelled-hotel-bookings-by-hotel-type"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data for figure 2</span></span>
<span><span class="va">hotels_summary2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels_clean</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">is_canceled</span>, <span class="va">hotel</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'is_canceled'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate figure 2 using geom_bar()</span></span>
<span><span class="va">figure2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">hotels_summary2</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">hotel</span>, y<span class="op">=</span><span class="va">n</span>, fill<span class="op">=</span><span class="va">is_canceled</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add stacked bar plot</span></span>
<span>           <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Specify color manual</span></span>
<span>           <span class="fu">scale_fill_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cancelled booking"</span>,</span>
<span>                             values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#40B0A6"</span>, <span class="st">"#E1BE6A"</span><span class="op">)</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add labels</span></span>
<span>           <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Hotel type"</span>,</span>
<span>                y<span class="op">=</span><span class="st">"Number of hotel bookings"</span>,</span>
<span>                title<span class="op">=</span><span class="st">"Number of completed and cancelled hotel bookings by hotel type"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"Larger number of bookings and cancellations in city hotels"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the theme</span></span>
<span>           <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">figure2</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="figure-3-characteristics-of-hotel-bookings-by-cancellation">Figure 3: Characteristics of hotel bookings by cancellation<a class="anchor" aria-label="anchor" href="#figure-3-characteristics-of-hotel-bookings-by-cancellation"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data for figure 3</span></span>
<span><span class="co"># Mean of continuous characteristics by cancellation</span></span>
<span><span class="va">hotels_summary3_mean</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels_clean</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">is_canceled</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    lead_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lead_time</span><span class="op">)</span>,</span>
<span>    stays_in_weekend_nights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">stays_in_weekend_nights</span><span class="op">)</span>,</span>
<span>    stays_in_week_nights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">stays_in_week_nights</span><span class="op">)</span>,</span>
<span>    adults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">adults</span><span class="op">)</span>,</span>
<span>    childbaby <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">childbaby</span><span class="op">)</span>,</span>
<span>    booking_changes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">booking_changes</span><span class="op">)</span>,</span>
<span>    adr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">adr</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lead_time</span>, <span class="va">stays_in_weekend_nights</span>, <span class="va">stays_in_week_nights</span>, <span class="va">adults</span>, <span class="va">childbaby</span>, <span class="va">booking_changes</span>, <span class="va">adr</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"measure"</span>, values_to <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Standard deviation of continuous characteristics by cancellation</span></span>
<span><span class="va">hotels_summary3_sd</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">hotels_clean</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">is_canceled</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    lead_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">lead_time</span><span class="op">)</span>,</span>
<span>    stays_in_weekend_nights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">stays_in_weekend_nights</span><span class="op">)</span>,</span>
<span>    stays_in_week_nights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">stays_in_week_nights</span><span class="op">)</span>,</span>
<span>    adults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">adults</span><span class="op">)</span>,</span>
<span>    childbaby <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">childbaby</span><span class="op">)</span>,</span>
<span>    booking_changes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">booking_changes</span><span class="op">)</span>,</span>
<span>    adr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">adr</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lead_time</span>, <span class="va">stays_in_weekend_nights</span>, <span class="va">stays_in_week_nights</span>, <span class="va">adults</span>, <span class="va">childbaby</span>, <span class="va">booking_changes</span>, <span class="va">adr</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"measure"</span>, values_to <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Join for combined dataset for mean and standard deviation of characteristics</span></span>
<span><span class="va">hotels_summary3</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">hotels_summary3_mean</span>, <span class="va">hotels_summary3_sd</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is_canceled"</span>, <span class="st">"measure"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hotels_summary3_1</span> <span class="op">&lt;-</span> <span class="va">hotels_summary3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">measure</span><span class="op">==</span><span class="st">"lead_time"</span> <span class="op">|</span> <span class="va">measure</span> <span class="op">==</span> <span class="st">"adr"</span><span class="op">)</span></span>
<span><span class="va">hotels_summary3_2</span> <span class="op">&lt;-</span> <span class="va">hotels_summary3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">measure</span><span class="op">!=</span><span class="st">"lead_time"</span> <span class="op">&amp;</span> <span class="va">measure</span> <span class="op">!=</span> <span class="st">"adr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modify the labels for facet</span></span>
<span><span class="va">measure.labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time before arrival"</span>, <span class="st">"Average daily rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">measure.labs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lead_time"</span>, <span class="st">"adr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate figure 3 using geom_bar() and geom_errorbar()</span></span>
<span><span class="va">figure3_1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">hotels_summary3_1</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">is_canceled</span>, y<span class="op">=</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="co"># Add the bar plot for mean of characteristics</span></span>
<span>             <span class="fu">geom_bar</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"identity"</span>, </span>
<span>             fill<span class="op">=</span><span class="st">"#E1BE6A"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="co"># Add the error bar for standard deviation of characteristics</span></span>
<span>             <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax<span class="op">=</span><span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="co"># Create facet by variable</span></span>
<span>             <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">measure</span>, ncol<span class="op">=</span><span class="fl">2</span>, labeller <span class="op">=</span> <span class="fu">labeller</span><span class="op">(</span>measure <span class="op">=</span> <span class="va">measure.labs</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>             <span class="co"># Add labels</span></span>
<span>             <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Bookings cancelled"</span>,</span>
<span>                  y<span class="op">=</span><span class="st">"Mean and standard deviation"</span>,</span>
<span>                  title<span class="op">=</span><span class="st">"Characteristics of bookings by cancellation"</span>,</span>
<span>                  subtitle <span class="op">=</span> <span class="st">"Longer time and higher average daily rate among cancelled bookings"</span>,</span>
<span>                  caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="co"># Modify the theme</span></span>
<span>              <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       strip.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#D3E1D0"</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">figure3_1</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure3_1-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify the labels for facet</span></span>
<span><span class="va">measure.labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of weekend nights"</span>, <span class="st">"Number of weekdays"</span>, <span class="st">"Number of adults"</span>, <span class="st">"Number of children/babies"</span>, <span class="st">"Changes in bookings"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">measure.labs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stays_in_weekend_nights"</span>, <span class="st">"stays_in_week_nights"</span>, <span class="st">"adults"</span>, <span class="st">"childbaby"</span>, <span class="st">"booking_changes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate figure 3 using geom_bar() and geom_errorbar()</span></span>
<span><span class="va">figure3_2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">hotels_summary3_2</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">is_canceled</span>, y<span class="op">=</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="co"># Add the bar plot for mean of characteristics</span></span>
<span>             <span class="fu">geom_bar</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"identity"</span>, </span>
<span>             fill<span class="op">=</span><span class="st">"#E1BE6A"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="co"># Add the error bar for standard deviation of characteristics</span></span>
<span>             <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax<span class="op">=</span><span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="co"># Create facet by variable</span></span>
<span>             <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">measure</span>, ncol<span class="op">=</span><span class="fl">2</span>, labeller <span class="op">=</span> <span class="fu">labeller</span><span class="op">(</span>measure <span class="op">=</span> <span class="va">measure.labs</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>             <span class="co"># Add labels</span></span>
<span>             <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Bookings cancelled"</span>,</span>
<span>                  y<span class="op">=</span><span class="st">"Mean and standard deviation"</span>,</span>
<span>                  title<span class="op">=</span><span class="st">"Characteristics of bookings by cancellation (continued)"</span>,</span>
<span>                  subtitle <span class="op">=</span> <span class="st">"Number of weekdays and weekend days and adult guests are higher among cancelled bookings"</span>,</span>
<span>                  caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="co"># Modify the theme</span></span>
<span>             <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       strip.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#D3E1D0"</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">figure3_2</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure3_2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="univariate-analysis-for-the-association-between-each-characteristic-and-odds-of-cancelled-booking">Univariate analysis for the association between each characteristic
and odds of cancelled booking<a class="anchor" aria-label="anchor" href="#univariate-analysis-for-the-association-between-each-characteristic-and-odds-of-cancelled-booking"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store the name of outcome and continuous and cateogorical variables</span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="va">hotels_clean</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">is_canceled</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">colnames</span></span>
<span><span class="va">covars_cont</span> <span class="op">&lt;-</span> <span class="va">hotels_clean</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">lead_time</span>, <span class="va">stays_in_weekend_nights</span>, <span class="va">stays_in_week_nights</span>, <span class="va">adults</span>, <span class="va">childbaby</span>, <span class="va">booking_changes</span>, <span class="va">adr</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">colnames</span></span>
<span><span class="va">covars_cat</span> <span class="op">&lt;-</span> <span class="va">hotels_clean</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">hotel</span>, <span class="va">arrival_date_year</span>, <span class="va">arrival_date_season</span>, <span class="va">is_repeated_guest</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">colnames</span></span>
<span></span>
<span><span class="co"># Univariate logistic regression for continuous variables</span></span>
<span><span class="va">paramlist1</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span><span class="va">outcomes</span>, <span class="va">covars_cont</span><span class="op">)</span></span>
<span><span class="va">uni_summary1</span> <span class="op">&lt;-</span> <span class="va">paramlist1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mod <span class="op">=</span> <span class="fu">map2</span><span class="op">(</span><span class="va">outcomes</span>, <span class="va">covars_cont</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">reformulate</a></span><span class="op">(</span><span class="va">.y</span>, <span class="va">.x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hotels_clean</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         res <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">mod</span>, <span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">uni_summary1</span><span class="op">$</span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept) -<span style="color: #BB0000;">1.46</span>     0.072<span style="text-decoration: underline;">9</span>      -<span style="color: #BB0000;">20.0</span>  2.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-89</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> lead_time    0.003<span style="text-decoration: underline;">63</span>  0.000<span style="text-decoration: underline;">581</span>      6.24 4.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term                    estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)               -<span style="color: #BB0000;">1.34</span>     0.072<span style="text-decoration: underline;">1</span>    -<span style="color: #BB0000;">18.5</span>  8.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-77</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> stays_in_weekend_nights    0.200    0.054<span style="text-decoration: underline;">2</span>      3.69 2.25<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term                 estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)            -<span style="color: #BB0000;">1.41</span>     0.081<span style="text-decoration: underline;">0</span>    -<span style="color: #BB0000;">17.4</span>  5.27<span style="color: #949494;">e</span><span style="color: #BB0000;">-68</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> stays_in_week_nights    0.127    0.030<span style="text-decoration: underline;">6</span>      4.15 3.30<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">1.79</span>     0.199      -<span style="color: #BB0000;">9.00</span> 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-19</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> adults         0.332    0.099<span style="text-decoration: underline;">6</span>      3.33 8.70<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic   p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">1.22</span>     0.054<span style="text-decoration: underline;">8</span>    -<span style="color: #BB0000;">22.3</span>  1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-110</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> childbaby      0.329    0.086<span style="text-decoration: underline;">7</span>      3.79 1.49<span style="color: #949494;">e</span><span style="color: #BB0000;">-  4</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[6]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term            estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)       -<span style="color: #BB0000;">1.10</span>     0.055<span style="text-decoration: underline;">1</span>    -<span style="color: #BB0000;">20.0</span>  1.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-88</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> booking_changes   -<span style="color: #BB0000;">0.197</span>    0.074<span style="text-decoration: underline;">9</span>     -<span style="color: #BB0000;">2.63</span> 8.53<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[7]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept) -<span style="color: #BB0000;">1.93</span>     0.137       -<span style="color: #BB0000;">14.1</span>  2.59<span style="color: #949494;">e</span><span style="color: #BB0000;">-45</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> adr          0.006<span style="text-decoration: underline;">06</span>  0.000<span style="text-decoration: underline;">966</span>      6.28 3.49<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span></span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate logistic regression for categorical variables</span></span>
<span><span class="va">paramlist2</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span><span class="va">outcomes</span>, <span class="va">covars_cat</span><span class="op">)</span></span>
<span><span class="va">uni_summary2</span> <span class="op">&lt;-</span> <span class="va">paramlist2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mod <span class="op">=</span> <span class="fu">map2</span><span class="op">(</span><span class="va">outcomes</span>, <span class="va">covars_cat</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">reformulate</a></span><span class="op">(</span><span class="va">.y</span>, <span class="va">.x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hotels_clean</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         res <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">mod</span>, <span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">uni_summary2</span><span class="op">$</span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term              estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)         -<span style="color: #BB0000;">1.02</span>     0.056<span style="text-decoration: underline;">3</span>    -<span style="color: #BB0000;">18.1</span>  3.18<span style="color: #949494;">e</span><span style="color: #BB0000;">-73</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> hotelResort Hotel   -<span style="color: #BB0000;">0.713</span>    0.140      -<span style="color: #BB0000;">5.10</span> 3.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   term                  estimate std.error statistic p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)              -<span style="color: #BB0000;">17.6</span>      295.   -<span style="color: #BB0000;">0.059</span><span style="color: #BB0000; text-decoration: underline;">6</span>   0.952</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> arrival_date_year2016     16.3      295.    0.055<span style="text-decoration: underline;">3</span>   0.956</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> arrival_date_year2017     16.7      295.    0.056<span style="text-decoration: underline;">7</span>   0.955</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   term                      estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)               -<span style="color: #BB0000;">0.961</span>      0.092<span style="text-decoration: underline;">1</span>  -<span style="color: #BB0000;">10.4</span>    1.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-25</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> arrival_date_seasonSummer -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">97</span>    0.120    -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">8</span> 9.80<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> arrival_date_seasonFall   -<span style="color: #BB0000;">0.848</span>      0.169    -<span style="color: #BB0000;">5.02</span>   5.17<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> arrival_date_seasonWinter -<span style="color: #BB0000;">0.531</span>      0.189    -<span style="color: #BB0000;">2.81</span>   4.95<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term                 estimate std.error statistic   p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)             -<span style="color: #BB0000;">1.15</span>    0.051<span style="text-decoration: underline;">3</span>    -<span style="color: #BB0000;">22.4</span>  4.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-111</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> is_repeated_guestYes    -<span style="color: #BB0000;">1.74</span>    1.03       -<span style="color: #BB0000;">1.69</span> 9.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-  2</span></span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use map and map_Dbl() for coefficients of regression models</span></span>
<span><span class="va">coef1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">covars_cont</span>, <span class="va">outcomes</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span> <span class="fu">map</span><span class="op">(</span><span class="va">covars_cont</span>, <span class="kw">function</span><span class="op">(</span><span class="va">.y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">reformulate</a></span><span class="op">(</span><span class="va">.y</span>, <span class="va">.x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hotels_clean</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">flatten</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">summary</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">map</span><span class="op">(</span>.f <span class="op">=</span> <span class="va">coef</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">summary1</span> <span class="op">&lt;-</span> <span class="va">outcomes</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span> <span class="fu">map</span><span class="op">(</span><span class="va">covars_cont</span>, <span class="kw">function</span><span class="op">(</span><span class="va">.y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">reformulate</a></span><span class="op">(</span><span class="va">.y</span>, <span class="va">.x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hotels_clean</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">flatten</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error of regression models</span></span>
<span><span class="va">str1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">covars_cont</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">str1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">summary1</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create the summary table for univariate analysis</span></span>
<span><span class="va">uni_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">coef1</span>, <span class="va">str1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">uni_summary</span> <span class="op">&lt;-</span> <span class="va">uni_summary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="va">covars_cont</span>,</span>
<span>    coefficients <span class="op">=</span> <span class="va">V2</span>,</span>
<span>    strerr <span class="op">=</span> <span class="va">str1</span></span>
<span>    <span class="op">)</span> </span>
<span><span class="va">uni_summary</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">uni_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span>
<span><span class="va">uni_summary</span><span class="op">$</span><span class="va">strerr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">uni_summary</span><span class="op">$</span><span class="va">strerr</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="figure-4--summary-of-univariate-analysis">Figure 4. Summary of univariate analysis<a class="anchor" aria-label="anchor" href="#figure-4--summary-of-univariate-analysis"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify x labels for plot</span></span>
<span><span class="va">x_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Average daily rate'</span>, <span class="st">'N_adults'</span>, <span class="st">'Booking changes'</span>, <span class="st">'N_children'</span>, <span class="st">'Time before arrival'</span>, <span class="st">'N_weekdays'</span>, <span class="st">'N_weekends'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate figure 4 using geom_point() and geom_errorbar()</span></span>
<span><span class="va">Figure4</span> <span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">uni_summary</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">variable</span>, y<span class="op">=</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add points</span></span>
<span>           <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add error bars</span></span>
<span>           <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">coefficients</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">strerr</span>, ymax <span class="op">=</span> <span class="va">coefficients</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">strerr</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add horizontal line at y=0</span></span>
<span>           <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the x labels</span></span>
<span>           <span class="fu">scale_x_discrete</span><span class="op">(</span>labels<span class="op">=</span><span class="va">x_labels</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add labels</span></span>
<span>           <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Variable"</span>,</span>
<span>                y<span class="op">=</span><span class="st">"Log (odds ratio) and 95% confidence interval"</span>,</span>
<span>                title<span class="op">=</span><span class="st">"Summary of univariate analysis"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"All the continuous variables are significantly associated with cancellation"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the theme</span></span>
<span>           <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">Figure4</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure4-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivairable logistic regression </span></span>
<span><span class="co"># Year of booking and repeated guest are dropped as they are not significant in the univariate analysis</span></span>
<span><span class="va">mvr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">is_canceled</span><span class="op">~</span><span class="va">hotel</span> <span class="op">+</span> <span class="va">lead_time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">arrival_date_season</span><span class="op">)</span> <span class="op">+</span> <span class="va">stays_in_weekend_nights</span></span>
<span>                             <span class="op">+</span> <span class="va">stays_in_week_nights</span> <span class="op">+</span> <span class="va">adults</span> <span class="op">+</span> <span class="va">childbaby</span> <span class="op">+</span> <span class="va">booking_changes</span> <span class="op">+</span> <span class="va">adr</span>, </span>
<span>                             data <span class="op">=</span> <span class="va">hotels_clean</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mvr</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = is_canceled ~ hotel + lead_time + as.factor(arrival_date_season) + </span></span>
<span><span class="co">##     stays_in_weekend_nights + stays_in_week_nights + adults + </span></span>
<span><span class="co">##     childbaby + booking_changes + adr, family = binomial, data = hotels_clean)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)                          -2.510581   0.259002  -9.693  &lt; 2e-16 ***</span></span>
<span><span class="co">## hotelResort Hotel                    -0.863882   0.151992  -5.684 1.32e-08 ***</span></span>
<span><span class="co">## lead_time                             0.003593   0.000666   5.395 6.84e-08 ***</span></span>
<span><span class="co">## as.factor(arrival_date_season)Summer -0.211697   0.132160  -1.602   0.1092    </span></span>
<span><span class="co">## as.factor(arrival_date_season)Fall   -0.781374   0.176127  -4.436 9.15e-06 ***</span></span>
<span><span class="co">## as.factor(arrival_date_season)Winter -0.193728   0.205984  -0.941   0.3470    </span></span>
<span><span class="co">## stays_in_weekend_nights               0.147958   0.060934   2.428   0.0152 *  </span></span>
<span><span class="co">## stays_in_week_nights                  0.147392   0.033460   4.405 1.06e-05 ***</span></span>
<span><span class="co">## adults                                0.055005   0.111936   0.491   0.6231    </span></span>
<span><span class="co">## childbaby                             0.066526   0.104874   0.634   0.5259    </span></span>
<span><span class="co">## booking_changes                      -0.331462   0.076561  -4.329 1.50e-05 ***</span></span>
<span><span class="co">## adr                                   0.007937   0.001362   5.828 5.61e-09 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 2306.0  on 2096  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 2115.6  on 2085  degrees of freedom</span></span>
<span><span class="co">## AIC: 2139.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 4</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary dataset for coefficients and standard errors of the regression</span></span>
<span><span class="va">mvr_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mvr</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">mvr</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mvr_summary</span> <span class="op">&lt;-</span> <span class="va">mvr_summary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    coefficients <span class="op">=</span> <span class="va">V1</span>,</span>
<span>    strerr <span class="op">=</span> <span class="va">V2</span></span>
<span>    <span class="op">)</span> </span>
<span><span class="va">mvr_summary</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">mvr_summary</span><span class="op">)</span>  </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="figure-5--summary-of-multivariable-analysis">Figure 5. Summary of multivariable analysis<a class="anchor" aria-label="anchor" href="#figure-5--summary-of-multivariable-analysis"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify x labels for plot</span></span>
<span><span class="va">x_labels2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Average daily rate'</span>, <span class="st">'N_adults'</span>, <span class="st">"Fall"</span>, <span class="st">"Summer"</span>,<span class="st">"Winter"</span>, <span class="st">'Booking changes'</span>, <span class="st">'N_children'</span>, <span class="st">"Hotel type"</span>, <span class="st">'Time before arrival'</span>, <span class="st">'N_weekdays'</span>, <span class="st">'N_weekends'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate figure 5 using geom_point() and geom_errorbar()</span></span>
<span><span class="va">Figure5</span> <span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mvr_summary</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">variable</span>, y<span class="op">=</span><span class="va">coefficients</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add points</span></span>
<span>           <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add error bars</span></span>
<span>           <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">coefficients</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">strerr</span>, ymax <span class="op">=</span> <span class="va">coefficients</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">strerr</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add horizontal line at y=0</span></span>
<span>           <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the x labels</span></span>
<span>           <span class="fu">scale_x_discrete</span><span class="op">(</span>labels<span class="op">=</span><span class="va">x_labels2</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Add labels</span></span>
<span>           <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Variable"</span>,</span>
<span>                y<span class="op">=</span><span class="st">"Log (odds ratio) and 95% confidence interval"</span>,</span>
<span>                title<span class="op">=</span><span class="st">"Summary of multivariable analysis"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"Season and number of adults and children are not significant"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Kening Jiang"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="co"># Modify the theme</span></span>
<span>           <span class="va">custom_theme</span> <span class="op">+</span></span>
<span>                 <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span>, angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>                       axis.text.y<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>                       legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       legend.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>                       plot.subtitle<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                       legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       legend.box.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>                       plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">Figure5</span></span></code></pre></div>
<p><img src="Example%20analysis_files/figure-html/figure5-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Among 2,097 hotel bookings between 2015 and 2017 in the United
States, 501 (24%) bookings are cancelled and 1,596 (76%) bookings are
completed. We examined whether hotel type, time between booking and
arrival, season and year of the bookings, number of weekdays and weekend
days, number of adult guests, number of children/babies, changes to the
bookings, repeated guest, and average daily rate are associated with
cancelled bookings. In multivariable logistic regression, resort
(vs. city) hotel, fall (vs. spring) and changes in the bookings are
independently associated with lower odds of cancellations, while longer
time between booking and arrival, longer stays on weekdays and weekend
days, and higher average daily rating are independently associated with
higher odds of cancellations.</p>
</div>
<div class="section level2">
<h2 id="functions-used-in-the-analysis">Functions used in the analysis<a class="anchor" aria-label="anchor" href="#functions-used-in-the-analysis"></a>
</h2>
<div class="section level3">
<h3 id="data-wrangling">Data wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h3>
<ul>
<li>filter()</li>
<li>select()</li>
<li>mutate()</li>
<li>group_by()</li>
<li>summarise()</li>
<li>inner_join()</li>
<li>pivot_longer()</li>
</ul>
</div>
<div class="section level3">
<h3 id="purrr-functions">Purrr functions<a class="anchor" aria-label="anchor" href="#purrr-functions"></a>
</h3>
<ul>
<li>map()</li>
<li>map_dbl()</li>
<li>map2()</li>
</ul>
</div>
<div class="section level3">
<h3 id="functions-from-the-table1-package-in-the-vignette">Functions from the table1 package in the vignette<a class="anchor" aria-label="anchor" href="#functions-from-the-table1-package-in-the-vignette"></a>
</h3>
<ul>
<li>table1()</li>
<li>label()</li>
</ul>
</div>
<div class="section level3">
<h3 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h3>
<ul>
<li>geom_bar()</li>
<li>geom_point()</li>
<li>geom_errorbar()</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Created by Benjamin Rich, Kening Jiang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
